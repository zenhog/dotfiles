#!/usr/bin/env bash

mkdir -p "$HOME/.mail/mailbox"
mkdir -p "$HOME/.mail/proton"
mkdir -p "$HOME/.mail/gmail"

declare -A addrs=(
  [proton]=zemmouri.iskander@proton.me
  [gmail]=zemmouri.iskander@gmail.com
  [mailbox]=iskander.zemmouri@mailbox.org
)


if mbsync -a; then
  notmuch new 2>/dev/null
  notmuch tag +inbox +unread -new -- tag:new
  for addr in "${!addrs[@]}"; do
    notmuch tag -new -inbox -unread +sent +${addr} -- from:"${addrs[$addr]}"
  done
  widget mail timeout
fi
